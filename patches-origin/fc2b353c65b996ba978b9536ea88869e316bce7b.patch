From fc2b353c65b996ba978b9536ea88869e316bce7b Mon Sep 17 00:00:00 2001
From: Lu Yahan <yahan@iscas.ac.cn>
Date: Mon, 16 May 2022 10:15:34 +0800
Subject: [PATCH] [riscv64] fix build error

Change-Id: Ifaaa87234ab48869e828ba99e96de0d372538e81
Reviewed-on: https://chromium-review.googlesource.com/c/v8/v8/+/3647967
Commit-Queue: Yahan Lu <yahan@iscas.ac.cn>
Commit-Queue: ji qiu <qiuji@iscas.ac.cn>
Auto-Submit: Yahan Lu <yahan@iscas.ac.cn>
Reviewed-by: ji qiu <qiuji@iscas.ac.cn>
Cr-Commit-Position: refs/heads/main@{#80536}
---
 src/diagnostics/riscv64/disasm-riscv64.cc | 8 ++++++--
 1 file changed, 6 insertions(+), 2 deletions(-)

diff --git a/src/diagnostics/riscv64/disasm-riscv64.cc b/src/diagnostics/riscv64/disasm-riscv64.cc
index 42649b0c8a..46d44433c5 100644
--- a/src/diagnostics/riscv64/disasm-riscv64.cc
+++ b/src/diagnostics/riscv64/disasm-riscv64.cc
@@ -1631,7 +1631,9 @@ void Decoder::DecodeIType(Instruction* instr) {
       break;
     default:
 #ifdef CAN_USE_RVV_INSTRUCTIONS
-      if (!DecodeRvvVL()) {
+      if (instr->vl_vs_width() != -1) {
+        DecodeRvvVL(instr);
+      } else {
         UNSUPPORTED_RISCV();
       }
       break;
@@ -1667,7 +1669,9 @@ void Decoder::DecodeSType(Instruction* instr) {
       break;
     default:
 #ifdef CAN_USE_RVV_INSTRUCTIONS
-      if (!DecodeRvvVS()) {
+      if (instr->vl_vs_width() != -1) {
+        DecodeRvvVS(instr);
+      } else {
         UNSUPPORTED_RISCV();
       }
       break;
-- 
2.35.1

