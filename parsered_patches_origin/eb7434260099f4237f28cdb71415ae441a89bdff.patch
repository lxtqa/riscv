From eb7434260099f4237f28cdb71415ae441a89bdff Mon Sep 17 00:00:00 2001
From: Al Muthanna Athamina <almuthanna@chromium.org>
Date: Tue, 5 Jul 2022 10:43:52 +0200
Subject: [PATCH] Add bots for RISC-V32

Bug: v8:13033
Change-Id: Ic2c13359a1e22846750d67342b2a682f6351b7da
Reviewed-on: https://chromium-review.googlesource.com/c/v8/v8/+/3743484
Reviewed-by: Michael Achenbach <machenbach@chromium.org>
Commit-Queue: Almothana Athamneh <almuthanna@chromium.org>
Cr-Commit-Position: refs/heads/main@{#81520}
---
 infra/mb/mb_config.pyl     |  8 ++++++++
 infra/testing/builders.pyl | 23 ++++++++++++++++++++++-
 2 files changed, 30 insertions(+), 1 deletion(-)

diff --git a/infra/mb/mb_config.pyl b/infra/mb/mb_config.pyl
index fdf3e72518..97e421a5b8 100644
--- a/infra/mb/mb_config.pyl
+++ b/infra/mb/mb_config.pyl
@@ -201,6 +201,7 @@
       'V8 Linux - ppc64 - sim - builder': 'release_simulate_ppc64',
       'V8 Linux - s390x - sim - builder': 'release_simulate_s390x',
       # RISC-V
+      'V8 Linux - riscv32 - sim - builder': 'release_simulate_riscv32',
       'V8 Linux - riscv64 - sim - builder': 'release_simulate_riscv64',
       # Loongson
       'V8 Linux - loong64 - sim - builder': 'release_simulate_loong64',
@@ -253,6 +254,7 @@
       'v8_linux64_fuzzilli_ng': 'release_x64_fuzzilli',
       'v8_linux64_loong64_rel_ng': 'release_simulate_loong64',
       'v8_linux64_msan_rel_ng': 'release_simulate_arm64_msan_minimal_symbols',
+      'v8_linux_riscv32_rel_ng': 'release_simulate_riscv32',
       'v8_linux64_riscv64_rel_ng': 'release_simulate_riscv64',
       'v8_linux64_tsan_rel_ng': 'release_x64_tsan_minimal_symbols',
       'v8_linux64_tsan_no_cm_rel_ng': 'release_x64_tsan_no_cm',
@@ -443,6 +445,8 @@
       'release_bot', 'simulate_mips64el'],
     'release_simulate_ppc64': [
       'release_bot', 'simulate_ppc64'],
+    'release_simulate_riscv32': [
+      'release_bot', 'simulate_riscv32'],
     'release_simulate_riscv64': [
       'release_bot', 'simulate_riscv64'],
     'release_simulate_s390x': [
@@ -878,6 +882,10 @@
       'gn_args': 'target_cpu="x64" v8_target_cpu="ppc64"',
     },
 
+    'simulate_riscv32': {
+      'gn_args': 'target_cpu="x86" v8_target_cpu="riscv32"',
+    },
+
     'simulate_riscv64': {
       'gn_args': 'target_cpu="x64" v8_target_cpu="riscv64"',
     },
diff --git a/infra/testing/builders.pyl b/infra/testing/builders.pyl
index 2162087017..35c1283e37 100644
--- a/infra/testing/builders.pyl
+++ b/infra/testing/builders.pyl
@@ -648,7 +648,15 @@
     ],
   },
   ##############################################################################
-  # Linux64 with RISC-V simulators
+  # Linux with RISC-V simulators
+  'v8_linux_riscv32_rel_ng_triggered': {
+    'swarming_dimensions': {
+      'os': 'Ubuntu-18.04',
+    },
+    'tests': [
+      {'name': 'v8testing', 'shards': 3},
+    ],
+  },
   'v8_linux64_riscv64_rel_ng_triggered': {
     'swarming_dimensions': {
       'os': 'Ubuntu-18.04',
@@ -1976,6 +1984,19 @@
       {'name': 'v8testing', 'shards': 3},
     ],
   },
+  'V8 Linux - riscv32 - sim': {
+    'swarming_dimensions': {
+      'os': 'Ubuntu-18.04',
+    },
+    'swarming_task_attrs': {
+      'expiration': 14400,
+      'hard_timeout': 3600,
+      'priority': 35,
+    },
+    'tests': [
+      {'name': 'v8testing', 'shards': 3},
+    ],
+  },
   'V8 Linux - riscv64 - sim': {
     'swarming_dimensions': {
       'os': 'Ubuntu-18.04',
-- 
2.35.1

